<html>
<head>
  <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<style>

path {
  fill: none;
  stroke: #000;
  stroke-width: 3px;
}
circle {
  fill: steelblue;
  stroke: #fff;
  stroke-width: 3px;
}

</style>
<div id="grid"></div>
<body>
<script>
  var bw = 40
  var bh = 40
  var r = 10
  var c = 10

  var points = [
  [20,180],
  [60,180],
  [60,220]
];


function gridData(r,c,bw,bh) {
  var data = new Array();
  var xpos = 1; //starting xpos and ypos at 1 so the stroke will show when we make the grid below
  var ypos = 1;
  var click = 0;


 // iterate for rows 
  for (var row = 0; row < r; row++) {
    data.push( new Array() );
    
    // iterate for cells/columns inside rows
    for (var column = 0; column < c; column++) {
      var wt = Math.round(Math.random() * (r - 0) + 0,0)

      data[row].push({
        x: xpos,
        y: ypos,
        width: bw,
        height: bh,
        click: click,
        weight: wt
      })
      // increment the x position. I.e. move it over by 50 (width variable)
      xpos += bw;
    }
    // reset the x position after a row is complete
    xpos = 1;
    // increment the y position for the next row. Move it down 50 (height variable)
    ypos += bh; 
  }
  return data;
}

var gridData = gridData(r,c,bw,bh);  
// I like to log the data to the console for quick debugging
console.log(gridData);

var grid = d3.select("#grid")
  .append("svg")
  .attr("width",((r*bw)+r)+"px")
  .attr("height",((c*bh)+c)+"px");
  
var row = grid.selectAll(".row")
  .data(gridData)
  .enter().append("g")
  .attr("class", "row");
  
var column = row.selectAll(".square")
  .data(function(d) { return d; })
  .enter().append("rect")
  .attr("class","square")
  .attr("x", function(d) { return d.x; })
  .attr("y", function(d) { return d.y; })
  .attr("width", function(d) { return d.width; })
  .attr("height", function(d) { return d.height; })
  .attr("weight",function(d) {return d.weight})
  .style("fill", "#fff")
  .style("stroke", "#222")
  .on('click', function(d) {
       d.click ++;
       if ((d.click)%4 == 0 ) { d3.select(this).style("fill","#fff"); }
     if ((d.click)%4 == 1 ) { d3.select(this).style("fill","#2C93E8"); }
     if ((d.click)%4 == 2 ) { d3.select(this).style("fill","#F56C4E"); }
     if ((d.click)%4 == 3 ) { d3.select(this).style("fill","#838690"); }
    })
  .on('mouseover',function(d) {return console.log(d.weight)});

// Draw Path
var path = grid.append("path")
    .data([points])
    .attr("d", d3.line(d3.curveLinear))
    ;
// Draw Circle at start of path
var circle = grid.append("circle")
    .attr('r',7)
    .attr("transform","translate(" +points[0]+ ")"); 




function transition() {
  circle.transition()
      .duration(2000)
      .attrTween("transform", translateAlong(path.node()))
      .each("end", transition);
}

// Returns an attrTween for translating along the specified path element.
function translateAlong(path) {
  var l = path.getTotalLength();
  return function(d, i, a) {
    return function(t) {
      var p = path.getPointAtLength(t * l);
      return "translate(" + p.x + "," + p.y + ")";
    };
  };
}  

//transition();
</script>



</body>
</html>